<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / Crittografia - Cifrari a blocchi</title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='CifrariABlocchi.html' title='Crittografia - Cifrari a blocchi'>Crittografia - Cifrari a blocchi</a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
</p><pre  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'> <strong>:: Crittografia - Cifrari a blocchi ::</strong>
</pre><p class='vspace'><a class='wikilink' href='Crittografia.html'>Torna alla pagina di Crittografia</a>
</p>
<p class='vspace'>I <strong>cifrari a blocchi</strong> lavorano su <strong>blocchi</strong> di n bit. Se ho n bit, vuol dire che posso avere 2<sup>n</sup> blocchi diversi. Quando trasformo il blocco di testo in chiaro in testo cifrato, occorre che la trasformazione da n bit in chiaro ad n bit cifrati sia <strong>univoca</strong>, ovvero <strong>reversibile</strong>, o anche <strong>non singolare</strong>.
</p>
<p class='vspace'>La <strong>chiave</strong> è quella che effettua questa mappatura tra n bit in chiaro ed n bit cifrati. In generale, se ho un blocco di n bit, la chiave deve avere lunghezza di almeno <strong>n * 2<sup>n</sup></strong> bit, perché deve coprire tutte le possibili mappature dei miei n bit.
</p>
<p class='vspace'>Infatti, se ho n bit di blocco, allora avrò 2<sup>n</sup> possibili valori del blocco. L'idea sarebbe che ogni singolo valore del blocco possa essere mappato in un altro singolo valore del blocco: una mappatura 1 a 1, in pratica. Mi occorrono quindi 2<sup>n</sup> mappature. Ogni mappatura è composta da una sequenza di n bit, trattandosi appunto di un blocco di n bit: ecco perché il valore totale è di n*2<sup>n</sup> bit.
</p>
<p class='vspace'>Ecco un esempio, che magari chiarisce un po' di più: se ho un blocco di 3 bit, ho i seguenti valori: 000, 001, 010, 011, 100, 101, 110, 111 = 2<sup>3</sup> = 8 valori.<br />Una possibile cifratura potrebbe essere questa:
</p><pre> 000 -&gt; 100
 001 -&gt; 101
 010 -&gt; 000
 011 -&gt; 110
 100 -&gt; 011
 101 -&gt; 111
 110 -&gt; 001
 111 -&gt; 010
</pre><p class='vspace'>La <strong>chiave</strong>, guardando questa tabella, è la <strong>colonna di destra</strong>. Devo infatti procedere così: il mio blocco ha valore 010, quindi prendo la 010-esima voce della tabella, e ho la sua cifratura. Si vede quindi che la colonna di destra è composta da 8 voci da 3 bit l'una: per l'appunto n * 2<sup>n</sup>
</p>
<p class='vspace'>Ma una chiave del genere è veramente troppo grossa, se uso blocchi di grosse dimensioni. Bisognerà quindi <strong>approssimare</strong> questo sistema ideale in un sistema reale, con chiavi molto più piccole.
</p>
<div class='vspace'></div><h3>La cifratura di Feistel</h3>
<p>Per approssimare, Feistel ha suggerito di usare due o più cifrature di base in sequenza, così che il prodotto sia più robusto della singola cifratura.
</p>
<p class='vspace'>Per realizzare questa robustezza, dobbiamo fare appello ai principi di <strong>confusione</strong> e <strong>diffusione</strong>, che servono per rompere l'analisi statistica del testo cifrato.
</p>
<p class='vspace'><strong>Diffusione</strong> vuol dire espandere in qualche modo la struttura statistica del testo in chiaro, e mapparla su un più grande intervallo di testo cifrato, così da "annebbiare" le analisi statistiche.<br />Per fare un esempio, se attuo una semplice cifratura a sostituzione in cui una lettera corrisponde ad una sola altra lettera, l'analisi delle frequenze mi dà la soluzione in poco tempo. Ma se invece per ottenere una lettera di testo cifrato devo lavorare su più lettere di testo in chiaro, allora l'analisi statistica ha meno successo. Ad esempio, Playfair usa bigrammi, e se è vero che posso sempre usare la frequenza dei bigrammi, è anche vero che mi serve più testo per poter cavar fuori qualcosa.
</p>
<p class='vspace'><strong>Confusione</strong> vuol dire invece complicare la relazione esistente tra il testo cifrato e la chiave, così anche se ho statistiche sul testo, non sono in grado di risalire alla chiave.
</p>
<p class='vspace'>Feistel proponeva il seguente sistema, per la diffusione. Invece di andare da m<sub>1</sub> -&gt; y<sub>1</sub>, dove m è una lettera del testo in chiaro e y è una del testo cifrato, uso le m<sub>1+k</sub> lettere successive, facendone la media:<br /><img src='../uploads/Uni/feistel01.jpg' alt='' title='' />
</p>
<p class='vspace'>Oppure, se ho blocchi binari, posso permutare, poi applicare una funzione <strong>f</strong>, poi permutare ancora, applicare ancora la <strong>f</strong> etc. La permutazione fa sì che al risultato della <strong>f</strong> contribuiscano più bit sparsi per il blocco.
</p>
<div class='vspace'></div><h3>Struttura di Feistel</h3>
<p>Il blocco è lungo <strong>2w bit</strong>, perché viene considerato come composto da <strong>2 parti</strong>, ciascuna lunga <strong>w</strong> bit.<br />Ho <strong>n</strong> fasi, e in ogni fase la parte di sinistra in output si chiama <strong>Ln</strong>, quella di destra <strong>Rn</strong>. La fase <strong>n</strong> prende in input le parti <strong>Ln-1</strong> e <strong>Rn-1</strong>.
</p>
<div class='vspace'></div><div><img src='../uploads/Uni/strutturafeistel.png' alt='' title='' /></div>
<p class='vspace'>Ecco quello che succede:
</p><ul><li>prendo i <strong>2w</strong> bit, e li divido in 2 parti
</li><li>la parte <strong>R0</strong> viene copiata in 2:
<ul><li>una copia entra nella <strong>F</strong>
</li><li>l'altra copia diventa la <strong>L</strong> della fase successiva
</li></ul></li><li>la parte <strong>L0</strong> viene <strong>XOR</strong>ata con l'output della <strong>F</strong>
</li><li>il risultato dello <strong>XOR</strong> diviene la parte <strong>R</strong> della fase successiva
</li></ul><p class='vspace'>La <strong>F</strong> è la funzione di crittografia scelta. Inoltre, dopo l'ultima fase, di solito c'è un'ulteriore scambio per invertire le posizioni di <strong>Rn</strong> e <strong>Ln</strong>.
</p>
<p class='vspace'>Ogni fase usa la <strong>Kn</strong>-esima chiave.
</p>
<p class='vspace'>Nella struttura di Feistel compaiono sia le <strong>sostituzioni</strong> che le <strong>permutazioni</strong>.<br />Abbiamo una sostituzione quando la parte <strong>L</strong> viene sostituita con lo <strong>XOR</strong> tra se stessa e l'output della <strong>F</strong>:
</p><pre> L1 = L0 XOR F(R0, K0)
</pre><p>Abbiamo la permutazione quando, nell'ultima parte di ogni fase, inverto la posizione di <strong>Ln</strong> e <strong>Rn</strong>, dove Ln e Rn sono gli output di ciascuna fase.
</p>
<p class='vspace'>Le reti di Feistel si caratterizzano per:
</p><ul><li>dimensione del blocco
</li><li>dimensione della chiave
</li><li>numero di fasi
</li><li>algoritmo per generare le sottochiavi
</li><li>funzione F
</li></ul><p class='vspace'>Per <strong>decrittografare</strong>, applico la stessa rete, partendo dal testo cifrato, <strong>ma</strong> usando le sottochiavi al contrario, ovvero nella prima fase uso l'ultima sottochiave usata nella crittografia, e così via.
</p>
<p class='vspace'>Funziona? Sì. Vediamo qui una struttura di Feistel ad 1 fase con il risultato dell'ultima fase scambiato di posto, come dicevo qui sopra.
</p>
<div class='vspace'></div><div><img src='../uploads/Uni/strutturafeistel2.png' alt='' title='' /></div>
<p class='vspace'>E adesso un po' di conti. Per crittografare, conosco L0, R0 e la chiave K
</p><pre> L1 = R0
 R1 = L0 XOR F(R0, K)

 L2 = R1 = L0 XOR F(R0, K)
 R2 = L1 = R0
</pre><p class='vspace'>Ora, per decrittografare, conosco solo R2, L2 e la chiave K, oltre che ovviamente l'algoritmo.
</p><pre> R0 lo ottengo, perché ho R2, e so che R2 = L1 = R0
 So che L2 = R1 = L0 XOR F (R0, K) 
 =&gt; L2 = L0 XOR F (R0, K)
 =&gt; L0 = L2 XOR F (R0, K)
 L2 ce l'ho, R0 ce l'ho, K ce l'ho =&gt; so ricavare anche L0.
</pre><p class='vspace'>Se applico per tutte le fasi riesco a risalire al messaggio originale.
</p>
<p class='vspace'><a class='wikilink' href='Crittografia.html'>Torna alla pagina di Crittografia</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/CifrariABlocchi)</span></div>
  </div>
</body>
</html>
