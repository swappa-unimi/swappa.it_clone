<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / Protocolli avanzati di rete - Appunti del 24 Marzo</title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='PAR-24Marzo.html' title='Protocolli avanzati di rete - Appunti del 24 Marzo'>Protocolli avanzati di rete - Appunti del 24 Marzo</a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
<a class='wikilink' href='ProtocolliAvanzatiDiRete.html'>Torna alla pagina di Protocolli avanzati di rete</a>
</p><hr />
<div class='vspace'></div><pre  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'> <strong>:: Protocolli avanzati di rete - Appunti del 24 Marzo ::</strong>
</pre><div class='vspace'></div><h2>Reti di base e reti overlay</h2>
<p>Nella <a class='wikilink' href='PAR-23Marzo.html'>scorsa lezione</a> abbiamo detto che l' <strong>OSPF</strong> è un protocollo <code class='escaped'>link state</code>. <br />Ora supponiamo di avere una rete di questo tipo:
</p>
<div class='vspace'></div><div><span class='frame lfloat'><img src='../uploads/Uni/PARreteBase.jpg' alt='' title='' /><br /><strong>Rete base</strong></span></div>
<p>Se A manda un messaggio LSA lo riceve solo B.<br />Se lo manda B lo ricevono A, C, D.<br />Se lo manda D lo riceve solo B.<br />Se lo manda C lo riceve solo B.
</p>
<p class='vspace'>Abbiamo quindi una serie di relazioni di vicinato, come avviene nel protocollo RIP. Ovviamente si potranno prevedere delle propagazioni dei messaggi per mettere in comunicazione nodi non adiacenti, ma dovranno sempre passare dal vicinato per raccogliere informazioni sulla rete.
</p>
<p class='vspace'>Come cambiare questa situazione?
<br clear='all' />
</p>
<div class='vspace'></div><div><span class='frame rfloat'><img src='../uploads/Uni/PARbroadcast.jpg' alt='' title='' /><br /><strong>Rete overlay</strong></span></div>
<p>Per far si che ogni nodo della rete possa costruirsi una propria tabella di instradamento e mantenerla aggiornata, occorre introdurre il <strong>relay</strong> (letteralmente, "rilancio"), ossia quel meccanismo grazie al quale se un nodo manda un LSA al vicino questi lo replica a sua volta ai suoi vicini, e così via. Utilizzando questa tecnica riusciamo così a passare da una rete a grafo magliato (di base) ad una a grafo completo, cioè in broadcast. In una rete overlay la matrice di adiacenza diventerà dunque facilissima da costruire per qualsiasi nodo, proprio in virtù del fatto che tutti ricevono i messaggi di tutti (dove ovviamente per "tutti" intendiamo quei router che appartengono allo stesso autonomous system).
</p>
<p class='vspace'>La rete di base vista sopra cambia dunque aspetto (figura a destra) e comportamento: quando B riceve qualcosa da A, se il messaggio è più recente di quello che ha già allora lo inoltra a tutti gli altri.
<br clear='all' />
</p>
<p class='vspace'>Abbiamo detto che ogni nodo controlla se il messaggio è più recente di un altro che era già in suo possesso, ma perché? Per forza di cose il relay comporta una duplicazione dei messaggi, dunque un'informazione come il timestamp sarà fondamentale per distinguere quelli vecchi (da scartare) da quelli nuovi da tenere in considerazione.
</p>
<p class='vspace'>Ultima osservazione: la rete overlay non serve per costruire le matrici di adiacenza della rete overlay stessa, perché dato che è un broadcast sarebbe composta di soli 1. Con la overlay network si costruiscono invece le tabelle di adiacenza della rete di base.
</p>
<p class='vspace'>Riassumendo...
</p><div  style='text-align: center;'><img src='../uploads/Uni/PARrelayOverlay.jpg' alt='' title='' /></div>
<div class='vspace'></div><h2>Approfondimento OSPF</h2>
<p>Abbiamo già ricordato che l' <strong>OSPF</strong> è un protocollo <code class='escaped'>link state</code>, in cui tutti i nodi costruiscono la tabella di instradamento (o <em>matrice delle adiacenze</em>) inviandosi la lista dei rispettivi vicini. Va da sé che questa matrice deve essere in costante aggiornamento, perché se diventasse statica smetterebbe di rappresentare la situazione attuale della rete.<br />Il link state si contrappone ai protocolli RIP (vedi <a class='wikilink' href='Sistemi.html'>Sistemi</a>) nei quali la tabella di ciascun nodo contiene solo la lista degli hop vicini.<br />
Nell'OSPF La matrice viene costruita come segue:
</p><ul><li>ogni hop manda ai vicini un messaggio di LSA per dire che sono disponibili
</li><li>ciascun nodo manda la tabella ai vicini
</li><li>ad ogni modifica della rete (ad esempio l'aggiunta di un nodo o l'indisponibilità di un altro) o allo scadere di un timestamp, ripartono i messaggi LSA per aggiornarla
</li></ul><p class='vspace'>Il messaggio LSA contiene una lista dei vicini del mittente, più il <em>round-trip-time medio</em>. Altri protocolli utilizzano altre metriche al posto del round-trip-time, come ad esempio il numero dei pacchetti in coda per arrivare a destinazione. Tali metriche devono però essere indicative della situazione e non troppo sensibili (o ci sarebbe un'alta variabilità dei tragitti).
</p>
<p class='vspace'>Se eleviamo ad un certo numero <code class='escaped'>k</code> la matrice delle adiacenze <code class='escaped'>M</code> di una rete di base, sapremo quali sono i nodi connessi da cammini di lunghezza <code class='escaped'>k</code>. Potremo utilizzare quest'informazione per l'instradamento, dato che fornisce indicazioni preziose sul next-hop a distanza minima da scegliere.<br />Abbiamo già detto che la matrice delle adiacenze deve essere incessantemente aggiornata se vogliamo catturare la situazione reale, almeno una volta ogni 30 secondi. Questo intervallo di tempo è chiamato <em>HELLO time</em> e non dovrebbe essere troppo breve o il flooding (spostamento) del traffico da una rete all'altra avverrebbe in modo troppo drastico con le conseguenti difficoltà di gestione. A ogni modo, proprio il fatto che la matrice deve essere aggiornata ogni tot tempo è la ragione per cui i pacchetti che compongono il messaggio dovranno essere riordinati una volta arrivati a destinazione: la trasmissione di tipo FIFO è garantita solo su rotte costanti, non certo nelle situazioni reali dove c'è grande variabilità delle rotte. 
</p>
<div class='vspace'></div><h2>Approfondimento OSPF-TE</h2>
<p>Quando utilizziamo il protocollo per motivi di traffic engeneering (OSPF-TE) non è necessario aggiornare frequentemente la matrice, al limite solo per gestire eventuali congestioni o tener conto delle &#955; occupate. Inoltre non viene utilizzata la metrica del round-trip-time perché siamo su una rete circuit switching, e abbiamo perciò una linea esclusiva dove non si presentano problemi di latenza. A tale metrica campionaria (stocastica) si preferisce qualcosa che sia deterministico, ovvero calcolabile una sola volta e che rimanga fisso, ad esempio il <code class='escaped'>bitrate</code>. L'unica occasione in cui dovrò ricalcolarlo è in caso di guasto.
</p>
<p class='vspace'>L'OSPF-TE viene quindi usato per assegnare cammini e non più per gestire il controllo della congestione che mi permetteva di evitare i tratti trafficati, tanto una volta che ho la linea non ho più varianza del round-trip-time: il tempo di percorrenza rimane fisso al valore <code class='escaped'>L/T</code> (larghezza canale fratto il tempo?). 
</p>
<p class='vspace'>Cosa succede se una sorgente eccede la capacità del canale? Avrò bisogno di molto più spazio di banda, ma se la rete non è pronta a darmi un nuovo canale aumenterà il tempo di latenza perché il traffico è improvvisamente aumentato. Non posso dirottare il traffico in eccesso su un canale che in quel momento è libero (<code class='escaped'>idle</code>)? Attualmente no, l'OSPF-TE non è in grado di reagire in modo dinamico a queste situazioni, cosa che invece riusciva a fare benissimo nell'OSPF classico sulla rete normale. Ci sono però degli studi in atto per implementare questa flessibilità anche per la rete pubblica in futuro.
</p>
<p class='vspace'>Ricapitolando, mettiamo a confronto OSPF e OSPF-TE:
</p><ul><li>utilizzano lo stesso algoritmo
</li><li>non hanno lo stesso HELLO time, che è molto più lungo nell'OSPF-TE (anche di un'ora)
</li><li>cambia la metrica: round-trip-time (dinamico) per l'OSPF, metrica statica (ad esempio il bitrate) per l'altro
</li><li>l'OSPF reagisce in modo dinamico ai problemi di congestione di traffico
</li><li>il loro comportamento su fibra è del tutto identico
</li></ul><div class='vspace'></div><hr />
<p><a class='wikilink' href='ProtocolliAvanzatiDiRete.html'>Torna alla pagina di Protocolli avanzati di rete</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/PAR-24Marzo)</span></div>
  </div>
</body>
</html>
