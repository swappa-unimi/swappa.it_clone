<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / Ricerca Operativa - PL - Dosaggio farmaci - 01.07</title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='RO-PL-gen2007.html' title='Ricerca Operativa - PL - Dosaggio farmaci - 01.07'>Ricerca Operativa - PL - Dosaggio farmaci - 01.07</a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
<a class='wikilink' href='RicercaOperativa.html'>Torna alla pagina di Ricerca Operativa</a>
</p><hr />
<div class='vspace'></div><pre  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'> <strong>:: Ricerca Operativa - PL - Dosaggio farmaci - 01.07 ::</strong>
</pre><div class='vspace'></div><h2>Testo del problema</h2>
<p>Nel trattamento farmacologico di un paziente un’équipe medica deve decidere le quantità ottimali di ogni farmaco da somministrare. Lo stato di salute del paziente viene misurato da alcuni parametri, ad esempio dalla quantità di date sostanze nel sangue. E’ noto da precedenti esperimenti l’effetto che ogni farmaco ha sull’aumento o diminuzione di ciascuno dei suddetti parametri. E’ noto inoltre lo stato iniziale del paziente, che si desume da recenti analisi compiute su di lui. Per ciascun parametro sono date una soglia minima ed una massima entro cui si vuole ricondurre o mantenere il parametro ed inoltre è noto un valore di riferimento a cui ci si vuole avvicinare il più possibile. Si vuole cioè minimizzare il rapporto tra lo scostamento dal valore ideale ed il massimo scostamento consentito dalla soglia. Perciò uno scostamento in eccesso è misurato da (valore_ottenuto – valore_ideale) / (valore_max_consentito – valore_ideale) mentre uno scostamento in difetto è misurato da (valore_ideale – valore_ottenuto) / (valore_ideale – valore_min_consentito). Poiché si vuole che tutti gli scostamenti siano piccoli, si vuole minimizzare il massimo di essi.<br />Poiché ogni farmaco induce effetti collaterali indesiderati, la quantità di ogni farmaco somministrabile non può eccedere un dato valore massimo.<br />Formulare il problema, classificarlo e risolverlo con i dati del file DOSAGGIO.TXT. Discutere l’ottimalità della soluzione trovata.
</p>
<div class='vspace'></div><h3>Dati</h3>
<pre class='escaped'>
I parametri da valutare sono 7 (numerati 1...7), i farmaci disponibili 
sono 5 (indicati da A...E).

Tabella 1: Valori dei parametri e soglie [unità di misura non specificate]
Parametro   Valore    Soglia   Valore di    Soglia
            attuale   minima   riferimento  massima
    1        3.45       7.0      12.0        15.0
    2        1800      1700      2500        3500
    3        0.05      0.50      0.80        1.30
    4        3200      1400      2000        2750
    5        26.4       8.0      10.0        12.0     
    6          35        28        35          41
    7         136        80       120         160

Tabella 2: Effetto dei farmaci (variazione parametri per ogni mg di farmaco)

Parametro    Farmaco A      B      C      D      E
    1              -0.2   +0.5   +0.7   +0.1   +0.2
    2              -500    0.0   -250    +50    0.0
    3              +0.2   -0.1   +0.3    0.0   +0.2
    4               -80   -120    +15    -90   -100
    5              -8.5   -7.0   -1.0   -3.0   +1.0
    6                +5     -2     +8     -4      0
    7                -5     -1     -2     -3     +4

Tabella 3: Quantità max di farmaci somministrabili [mg]
Farmaco    Quantità
   A          2.0
   B          3.5
   C          0.5
   D          0.5
   E          7.5
</pre>
<div class='vspace'></div><h2>Formulazione del problema</h2>
<h3>Dati</h3>
<ul><li><strong>p = 7</strong> (numero parametri da valutare)
</li><li><strong>f = 5</strong> (numero farmaci disponibili)
</li><li><strong>valAtt<sub>i</sub></strong> (valore attuale del parametro i=1..7)
</li><li><strong>valRif<sub>i</sub></strong> (valore di riferimento del parametro i=1..7)
</li><li><strong>soMin<sub>i</sub></strong> (soglia minima del parametro i=1..7)
</li><li><strong>soMax<sub>i</sub></strong> (soglia massima del parametro i=1..7)
</li><li><strong>eff<sub>ij</sub></strong> (effetto del farmaco j=1..5 sul parametro i=1..7) [variazione/mg]
</li><li><strong>limFar<sub>j</sub></strong> (limite massimo farmaco j=1..5 somministrabile) [mg]
</li></ul><div class='vspace'></div><h3>Variabili</h3>
<ul><li><strong>x<sub>j</sub></strong> (quantità di farmaco j=1..5 da somministrare) [mg]
</li><li><strong>y<sub>i</sub></strong> (valore del parametro i=1..7 dopo la cura)
</li></ul><p class='vspace'>Le variabili sono continue e non negative.
</p>
<div class='vspace'></div><h3>Funzione obiettivo</h3>
<p>Bisogna minimizzare il massimo scostamento consentito dalla soglia. Introduciamo perciò una variabile ausiliaria z (che definiremo nei vincoli) che rappresenta il massimo degli scostamenti:
</p>
<p class='vspace'><strong>min z</strong>
</p>
<div class='vspace'></div><h3>Vincoli</h3>
<ul><li>vincolo sui valori minimi consentiti del parametro i<br /><strong>y<sub>i</sub> &gt;= soMin<sub>i</sub></strong> (per ogni i)
</li><li>vincolo sui valori massimi consentiti del parametro i<br /><strong>y<sub>i</sub> &lt;= soMax<sub>i</sub></strong> (per ogni i)
</li><li>vincolo sulle quantità massime di farmaco j somministrabile<br /><strong>x<sub>j</sub> &lt;= limFar<sub>j</sub></strong> (per ogni j)
<div class='vspace'></div></li><li>vincolo per mettere in relazione le cure prestate con i valori ottenuti<br /><em>dovremmo scrivere</em>: <strong>valAtt<sub>i</sub> - eff<sub>ij</sub> * x<sub>j</sub> = y<sub>i</sub></strong> (per ogni i)<br /><em>ma dato che le incognite vanno scritte tutte a sinistra, lo riscriviamo come:</em><br /><strong>eff<sub>ij</sub> * x<sub>j</sub> – y<sub>i</sub> = -valAtt<sub>i</sub></strong> (per ogni i)
<div class='vspace'></div></li><li>definiamo ora la variabile ausiliaria z per gli scostamenti in eccesso. Nel testo ci viene detto come calcolarla, ma trattandosi di un rapporto si tradurrebbe in un'espressione non lineare. Trasformiamola in forma lineare:<br /><strong>y<sub>i</sub> – (soMax<sub>i</sub> – valRif<sub>i</sub>) * z &lt;= valRif<sub>i</sub></strong> (per ogni i)
<div class='vspace'></div></li><li>definiamo infine la variabile ausiliaria z per gli scostamenti in difetto, anche in questo caso riesprimendola in forma lineare:<br /><strong>y<sub>i</sub> + (valRif<sub>i</sub> – soMin<sub>i</sub>) * z &gt;= valRif<sub>i</sub></strong> (per ogni i)
</li></ul><div class='vspace'></div><h2>Lindizzazione del problema</h2>
<pre class='escaped'>
! esercizio - Dosaggio farmaci

! variabili: x(j) = quantità di farmaco j da somministrare [mg]
! 	       y(i) = valore del parametro i dopo la cura
! le variabili sono continue e non negative

! funzione obiettivo
min z
! dove z è il massimo scostamento

st

! vincoli sui valori minimi consentiti
minVal1) y1 &gt;= 7.00
minVal2) y2 &gt;= 1700
minVal3) y3 &gt;= 0.50
minVal4) y4 &gt;= 1400
minVal5) y5 &gt;= 8.0
minVal6) y6 &gt;= 28
minVal7) y7 &gt;= 80

! vincoli sui valori massimi consentiti
maxVal1) y1 &lt;= 15.00
maxVal2) y2 &lt;= 3500
maxVal3) y3 &lt;= 1.30
maxVal4) y4 &lt;= 2750
maxVal5) y5 &lt;= 12.0     
maxVal6) y6 &lt;= 41
maxVal7) y7 &lt;= 160

! vincoli sulle quantità max di ogni farmaco [mg];
maxFar1) x1 &lt;= 2.0
maxFar2) x2 &lt;= 3.5
maxFar3) x3 &lt;= 0.5
maxFar4) x4 &lt;= 0.5
maxFar5) x5 &lt;= 7.5

! vincoli per mettere in relazione cure prestate con valori ottenuti
param1) -0.2 x1 +0.5 x2 +0.7 x3 +0.1 x4 +0.2 x5 - y1 = -3.45
param2) 500 x1 +0.0 x2 -250 x3 +50 x4 +0.0 x5 - y2 = -1800
param3) +0.2 x1 -0.1 x2 +0.3 x3 +0.0 x4 +0.2 x5 - y3 = -0.05
param4) -80 x1 -120 x2 +15 x3 -90 x4 -100 x5 - y4 = -3200
param5) -8.5 x1 -7.0 x2 -1.0 x3 -3.0 x4 +1.0 x5 - y5 = -26.4
param6) +5 x1 -2 x2 +8 x3 -4 x4 +0 x5 - y6 = -35
param7) -5 x1 -1 x2 -2 x3 -3 x4 +4 x5 - y7 = -136

! vincoli per definire lo scostamento z...
! ...in eccesso...
scoEcc1) y1 - 3.00 z &lt;= 12.0
scoEcc2) y2 - 1000 z &lt;= 2500
scoEcc3) y3 - 0.50 z &lt;= 0.80
scoEcc4) y4 - 750 z &lt;= 2000
scoEcc5) y5 - 2.0 z &lt;= 10.0
scoEcc6) y6 - 6 z &lt;= 35
scoEcc7) y7 - 40 z &lt;= 120

! ...e in difetto
scoDif1) y1 + 5.00 z &gt;= 12.0
scoDif2) y2 + 800 z &gt;= 2500
scoDif3) y3 + 0.30 z &gt;= 0.80
scoDif4) y4 + 600 z &gt;= 2000
scoDif5) y5 + 2.0 z &gt;= 10.0
scoDif6) y6 + 7 z &gt;= 35
scoDif7) y7 + 40 z &gt;= 120

end
</pre>
<div class='vspace'></div><h2>Altre domande</h2>
<h3>Nel caso in cui il paziente risultasse allergico ad uno dei farmaci (uno solo), fino a che punto potrebbe essere ridotta la quantità di farmaco senza compromettere la possibilità di rispettare i vincoli sulle soglie massima e minima per i parametri?</h3>
<p>Dovremo fare l'analisi parametrica del problema considerando un farmaco per volta, fissando a 0 la quantità massima di farmaco somministrabile e osservando fino a quando i vincoli di ammissibilità sono rispettati. Facciamo un esempio su tutti, saltando il primo farmaco (che dalla soluzione vediamo che non è mai utilizzato, dato che ha costo ridotto 0) e passando direttamente al secondo.
</p>
<div class='vspace'></div><pre class='escaped'>RIGHTHANDSIDE PARAMETRICS REPORT FOR ROW: MAXFAR2

    VAR       VAR    PIVOT    RHS       DUAL PRICE      OBJ
    OUT       IN      ROW     VAL      BEFORE PIVOT     VAL

                            3.50000      0.000000E+00  0.999623
 SLK   17  SLK   34     2   3.48571      0.000000E+00  0.999623
 SLK    3  SLK   36    34   3.47634      0.402597E-01   1.00000
 SLK    2  SLK   35    12   3.47634      0.463609E-01   1.00000
 SLK    6  SLK   39    30   3.47634      0.363281       1.00000
 SLK   11  ART         21   3.47634      0.422727       1.00000
                           0.000000E+00   +INFINITY   INFEASIBLE
</pre>
<p class='vspace'>Quindi il valore minimo consentito è di 3.47634.<br />Ripetiamo la stessa operazione per gli altri farmaci e ci risulterà che per il terzo farmaco il valore è 0.450929, per il quarto farmaco è 0.191030, e per l'ultimo farmaco è 7.27467.
</p>
<div class='vspace'></div><hr />
<p><a class='wikilink' href='RicercaOperativa.html'>Torna alla pagina di Ricerca Operativa</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/RO-PL-gen2007)</span></div>
  </div>
</body>
</html>
