<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / Gestione degli incidenti informatici - RFC 3227</title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='RFC3227.html' title='Gestione degli incidenti informatici - RFC 3227'>Gestione degli incidenti informatici - RFC 3227</a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
<a class='wikilink' href='GestioneDegliIncidentiInformatici.html'>Torna alla pagina di Gestione degli incidenti informatici</a>
</p><hr />
<p class='vspace'  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'><strong>:: RFC 3227 ::</strong>
</p>
<p class='vspace'  style='text-align: center;'><span  style='background-color: #d9e4f2; font-size: 11pt; padding: 4px; padding-left: 50px; padding-right: 50px;'>Linee guida per la raccolta e l'archiviazione di prove</span>
</p>
<div class='vspace'></div><h2>1 Introduzione</h2>
<p>Un incidente di sicurezza è un evento di sistema in cui le politiche di sicurezza sono state trasgredite o violate. Nella <strong>RFC 3227</strong> vengono suggerite alcune linee guida cui un amministratore di sistema può scegliere di attenersi ai fini di raccogliere e archiviare le prove digitali di incidenti di questo tipo.<br />Negli ultimi anni le operazioni di ripristino di un sistema compromesso sono diventate sempre più facili, altrettanto non si può dire delle attività di collezionamento di fonti di prova. Questa fase molto sottovalutata è in realtà fondamentale per comprendere le strategie e le tecniche operative di un attaccante, dunque per rendere il sistema più robusto in futuro.<br />Ultima nota prima di inoltrarci nella RFC: le linee guida ivi descritte non hanno validità giuridica in tutte le giurisdizioni, dunque è raccomandabile richiedere validazione legale dalle forze dell'ordine locali.
</p>
<div class='vspace'></div><h2>Principi guida durante la raccolta di prove</h2>
<ul><li>aderisci alle tue Politiche di Sicurezza e coinvolgi forze dell'ordine e personale dello CSIRT
</li><li>cattura l'immagine del sistema nel modo più fedele e accurato possibile
</li><li>mantieni annotazioni dettagliate che includano anche data e ora e che siano eventualmente generate in modo automatico
</li><li>per ogni timestamp raccolto indica anche l'UTC, così da segnalare il fuso orario del luogo in cui si trova la macchina
</li><li>tieni conto che potrai essere chiamato a dare conto delle tue scelte e delle tue azioni anche ad anni di distanza, quindi è vitale che le tue note siano chiare e dettagliate
</li><li>minimizza l'alterazione dei dati che stai collezionando, non solo da un punto di vista di contenuto ma anche per quanto riguarda altri attributi come ad esempio i tempi di accesso
</li><li>rimuovi le possibili vie esterne di modifica (esterne rispetto la macchina, ovviamente)
</li><li>se ti trovassi a dover scegliere tra fare prima la collezione o l'analisi, dai sempre priorità alla collezione
</li><li>le procedure che scegli di attuare devono essere implementabili e fattibili, in particolare in una situazione di crisi. Devono dunque essere definite in modo metodico, testate e possibilmente automatizzate
</li><li>dato che il tempo è un fattore critico, se hai un gran numero di dispositivi su cui effettuare la collezione di prove potresti organizzare col tuo team una raccolta in parallelo delle evidence, così da massimizzare la velocità. Viceversa, su un singolo dispositivo tali operazioni andrebbero fatte passo passo, in modo sequenziale
</li><li>la raccolta deve tener conto dell'ordine di volatilità dei dati (vedi paragrafo successivo)
</li><li>dovresti effettuare copie bit-by-bit dei dispositivi del sistema, così da preservare l'integrità dei dati (che in fase di analisi vedrebbero alterati alcuni loro attributi)
</li></ul><div class='vspace'></div><h3>2.1 Ordine di volatilità</h3>
<p>Quando si raccolgono le prove digitali bisognerebbe procedere da quelle più volatili a quelle meno volatili. A titolo d'esempio, ecco un tipico ordine di volatilità di un sistema comune:
</p><ol><li>registri, cache
</li><li>tabelle di routing, cache arp, tabella dei processi, statistiche del kernel, RAM
</li><li>file temporanei di sistema
</li><li>dischi
</li><li>log
</li><li>configurazioni fisiche e topologie di rete
</li><li>dispositivi di archiviazione
</li></ol><div class='vspace'></div><h3>2.2 Cose da evitare</h3>
<p>Dato che è fin troppo facile distruggere le prove collezionate, vediamo gli errori tipici da evitare.
</p>
<div class='vspace'></div><ul><li>non spegnere il sistema prima di aver terminato la raccolta, non solo perché perderesti le prove che stai attualmente recuperando, ma anche perché l'attaccante potrebbe aver modificato l'operazione di chiusura e ripristino del sistema in modo da cancellarne altre
</li><li>non fidarti dei programmi installati sul sistema, ma usa i tuoi e falli girare su dispositivi protetti esterni
</li><li>non eseguire programmi che potrebbero alterare le informazioni sui tempi di accesso di tutti i file del sistema (ad esempio "tar" o "xcopy")
</li><li>quando rimuovi le vie esterne di modifica tieni conto del fatto che la semplice disconnessione della macchina o il filtraggio spartano delle comunicazioni potrebbe far scattare dei meccanismi  introdotti dall'attaccante  per cancellare le prove
</li></ul><div class='vspace'></div><h3>2.3 Considerazioni sulla privacy</h3>
<ul><li>rispetta le regole e le linee guida sulla privacy della tua azienda e del tuo sistema giuridico, in particolare assicurati che nessuno che non sia autorizzato possa accedere alle informazioni fornite dalle prove raccolte (log o file personali che siano)
</li><li>a meno che tu non abbia ottimi motivi non invadere mai la privacy altrui, soprattutto se stai collezionando informazioni da aree in cui normalmente non avresti accesso (ad esempio file personali)
</li><li>assicurati sempre di stare rispettando le procedure stabilite dalla compagnia
</li></ul><div class='vspace'></div><h3>2.4 Considerazioni legali</h3>
<p>Le prove digitali devono essere:
</p><ul><li>ammissibili, cioè devono essere conformi a determinate norme legali perché possano essere usate in tribunale
</li><li>autentiche, ovvero bisogna poter dimostrare il collegamento tra il materiale probatorio e l'incidente
</li><li>complete, che non tengano cioè conto di un'unica prospettiva ma dell'intero accaduto
</li><li>affidabili, dato che non deve esserci nulla che possa dare adito a dubbi sulla loro autenticità o veridicità
</li><li>credibili, ovvero che siano allo stesso tempo comprensibili e attendibili per un tribunale
</li></ul><div class='vspace'></div><h2>3. La procedura di raccolta</h2>
<p>La procedura di raccolta dovrebbe essere descritta nel modo più dettagliato e meno ambiguo possibile, in modo da minimizzare il numero di decisioni da prendere in fase operativa.
</p>
<div class='vspace'></div><h3>3.1 Trasparenza</h3>
<p>Il metodo di raccolta delle prove dovrebbe essere trasparente e riproducibile, oltre che testato da esperti indipendenti.
</p>
<div class='vspace'></div><h3>3.2 Passi di raccolta</h3>
<ul><li>elencare i sistemi coinvolti nell'incidente e dire da quali di questi bisognerà raccogliere le prove
</li><li>stabilire quali tra queste sono rilevanti ed ammissibili, tenendo sempre conto che è meglio raccoglierne troppe che troppo poche
</li><li>tener sempre conto dell'ordine di volatilità
</li><li>rimuovere le possibili vie esterne di modifica
</li><li>usare gli strumenti di collezione che specificheremo nel capitolo 5
</li><li>chiedersi man mano che si procede con la raccolta se c'è qualcos'altro che si può considerare prova
</li><li>documentare ogni passaggio
</li><li>non dimenticarsi delle persone coinvolte: prendere nota di chi è presente alle varie operazioni, che osservazioni fa, che reazioni ha
</li></ul><p class='vspace'>Ove possibile è meglio fare uso di checksum e altre firme crittografiche per ogni prova, così da rendere più sicura e robusta la conservazione futura.
</p>
<div class='vspace'></div><h2>4. La procedura di archiviazione</h2>
<p>Le prove devono essere assolutamente messe in sicurezza e l'intero inventario (chiamato <em>chain of custody</em>) deve essere documentato.
</p>
<div class='vspace'></div><h3>4.1 Chain of custody</h3>
<p>Bisogna descrivere in modo chiaro e preciso come hai trovato la prova, come l'hai utilizzata e qualsiasi altra cosa tu ci abbia fatto. Più precisamente, ecco cosa bisogna specificare:
</p><ul><li>dove, quando e da chi è stata trovata e raccolta la prova
</li><li>dove, quando e da chi è stata maneggiata o esaminata
</li><li>chi ha in custodia la prova, per quanto tempo e come l'ha memorizzata
</li><li>come, quando e con quali modalità cambia la custodia
</li></ul><div class='vspace'></div><h3>4.2 Dove e come archiviare</h3>
<p>Utilizzate se possibile dispositivi convenzionali e non qualche oscuro sistema di archiviazione. L'accesso alle prove deve essere estramamente limitato e monitorato, e in ogni caso sempre documentato.
</p>
<div class='vspace'></div><h2>5. Strumenti di cui hai bisogno</h2>
<p>I programmi per la raccolta e l'analisi delle prove digitali dovrebbero girare su supporti di sola lettura (come i CD) ed essere specifici per ogni sistema operativo.
Tra gli strumenti di cui hai bisogno ci sono sicuramente:
</p><ul><li>programmi per l'analisi dei processi (ad esempio "ps")
</li><li>programmi per l'analisi dello stato del sistema (ad esempio "showrev", "ifconfig", "netstat", "arp")
</li><li>programmi per la copia bit-by-bit (ad esempio "dd")
</li><li>programmi per generare checksum e firme (ad esempio "sha1sum", "pgp")
</li><li>programmi per generare immagini del sistema per poi esaminarle
</li><li>script per automatizzare la raccolta di prove
</li></ul><p class='vspace'>Tutti questi programmi non devono richiedere librerie che non siano già contenute nel supporto, e in ogni caso bisogna sempre testarne l'autenticità e l'affidabilità.
</p>
<div class='vspace'></div><hr />
<p><a class='wikilink' href='GestioneDegliIncidentiInformatici.html'>Torna alla pagina di Gestione degli incidenti informatici</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/RFC3227)</span></div>
  </div>
</body>
</html>
