<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / Digital Investigation e Digital Forensic</title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='DigitalInvestigationEDigitalForensic.html' title='Digital Investigation e Digital Forensic'>Digital Investigation e Digital Forensic</a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
<a name='su' id='su'></a>
<a class='wikilink' href='GestioneDegliIncidentiInformatici.html'>Torna alla pagina di Gestione degli incidenti informatici</a>
</p><hr />
<p class='vspace'  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'><strong>:: Digital Investigation e Digital Forensic ::</strong>
</p>
<div class='vspace'></div><div class='frame' > 
<p>Ove non meglio specificato, tutti i testi tra virgolette vanno intesi come citazioni letterali dalle slide del prof <a class='wikilink' href='DarioForte.html'>Dario Forte</a>, 2008.
</p></div>
<div class='vspace'></div><h2>Definizioni</h2>
<p>Le definizioni che seguiranno di <em>Digital Investigation</em> e <em>Digital Forensic</em> sono di <strong>Brian Carrier</strong>, autore del libro <code class='escaped'>File System Forensic Analysis</code> e sviluppatore del programma di computer forensic <code class='escaped'>The Sleuth Kit</code> e della sua interfaccia <code class='escaped'>Autopsy</code>.
</p>
<p class='vspace'>La <strong>Digital Investigation</strong> è quell'attività in cui vengono sviluppate e testate ipotesi che potrebbero rispondere a domande su determinati <em>eventi digitali</em>, quindi non solo sugli incidenti informatici ma su un qualsiasi oggetto digitale utilizzato. Per <strong>Digital Forensic</strong> si intende invece un processo che si avvale di scienza e tecnologia per l'analisi di oggetti digitali, sviluppando e testando teorie che possono avere valenza legale. Come si può notare ci sono delle analogie tra le due attività, e in particolare si può dire che la digital forensic è un'investigazione più rigorosa che tiene conto anche degli aspetti legali.
</p>
<p class='vspace'>Per capire meglio di cosa stiamo parlando può essere utile fare un esempio su chi sono gli attori tipici dei due processi:
</p><ul><li>per la <em>Digital Investigation</em>: le forze dell'ordine, che sulla base delle ipotesi che stanno cercando di dimostrare nel corso delle indagini possono prendere provvedimenti nei confronti dei presunti colpevoli
</li><li>per la <em>Digital Forensic</em>: un perito consultato da un'azienda o da un tribunale, dalle cui conclusioni non seguono provvedimenti legali di alcun tipo, dato che questi rimangono di competenza delle autorità giudiziarie
</li></ul><p>Da notare che in alcuni casi i due ruoli possono sovrapporsi.
</p>
<div class='vspace'></div><h2>Processo Investigativo</h2>
<p>Sia la Digital Investigation che la Forensic Analysis hanno un imperativo comune: <strong>preservare l'integrità dei dati originali</strong>. Detto ciò, l'analisi forense viene comunemente condotta a livello di laboratorio (isolato dall'esterno), così che i processi e le procedure previste possano essere applicate in modo sistematico; nella Digital Investigation invece questa rigorosità non è altrettanto essenziale in quanto lo scopo è verificare delle ipotesi e non ricostruire esattamente i fatti.
</p>
<p class='vspace'>Secondo la corrente di pensiero "<code class='escaped'>Carrier/Spafford</code>" il modello del processo investigativo è diviso in sei fasi, che di seguito elencheremo brevemente per studiarle meglio poi nello specifico:
</p>
<div class='vspace'></div><ul><li><strong>Notifica</strong>
</li><li><strong>Preservation</strong>
</li><li><strong>Survey</strong>
</li><li><strong>Analysis</strong>
</li><li><strong>Reconstruction</strong>
</li><li><strong>Presentation</strong>
</li></ul><div class='vspace'></div><h3>Notifica</h3>
<p>La <strong>notifica</strong> è il momento in cui viene segnalato un incidente informatico alle figure interessate, che ciò avvenga per via telefonica, sistemi di allarme o altro. Da questo momento parte il processo investigativo, che può aver bisogno di un'autorizzazione a procedere e in alcuni casi anche di una conferma del reale accadimento dell'incidente. Il tutto deve essere ovviamente certificato con una serie di documenti, e ovviamente anche nella <em>Timeline</em> (la tabella dei tempi che vedremo meglio nella pagina di <a class='wikilink' href='StrumentiDiInvestigazioneEForensic.html'>Strumenti di investigazione e forensic</a>).<br />Il tecnico che riceve la notifica non può rifiutarsi di avviare le indagini, ma qualora si ritenesse che questi non abbia le competenze adatte per portarla avanti, può essere sollevato dall'incarico.
</p>
<div class='vspace'></div><h3>Preservation</h3>
<p>La <strong>preservation</strong> prevede la duplicazione dell'intero ambiente operativo di una scena digitale, così che possa essere facilmente riproducibile e utilizzabile in laboratorio senza che sia alterato l'originale; va da sé che quest'ultimo deve essere custodito e preservato per tutta la durata dell'indagine. Durante questa fase vanno prese alcune precauzioni, come isolare il sistema dalla rete esterna, rispettare l' <em>ordine di volatilità</em> delle informazioni, avere particolare attenzione per tutti i file di log, prendere nota di eventuali processi o servizi sospetti in esecuzione. 
</p>
<p class='vspace'>Per quanto riguarda le memorie fisiche la preservation viene garantita effettuando una o più copie bit-by-bit, mentre per il traffico di rete vengono utilizzate sonde di livello ISO/OSI 3 (quello di trasporto), chiamate <em>sniffer</em>. 
</p>
<p class='vspace'>Anticipiamo qui l'importanza della correlazione (<em>corroboration</em>) delle fonti di prova per dare maggiore validità alla conclusioni dell'analisi. A tal proposito era stato citato in classe il caso di presunta pedopornografia di una studentessa di Pisa, rivelatosi poi infondato confrontando più evidence.
</p>
<div class='vspace'></div><h3>Survey</h3>
<p>Il <strong>survey</strong> è un insieme di attività generali finalizzate alla ricerca delle fonti di prova (<em>digital evidence</em>). Dovrebbe essere svolta in laboratorio e possibilmente sulle copie prodotte nella fase precedente, ma può capitare che per motivi di urgenza si debba ricorrere a una <em>Live System Analysis</em> (<em>LSA</em>) sul sistema originale. E' un passaggio molto importante della digital investigation poiché consente alle forze dell'ordine di confermare alcune ipotesi e prendere se necessario provvedimenti giudiziari.
</p>
<p class='vspace'>Nel survey si capisce se chi effettua l'indagine è una persona adatta al compito dal momento che in questa fase emergono le abilità e competenze (<em>skills</em>) di chi ha commesso la violazione.
</p>
<div class='vspace'></div><h3>Analysis</h3>
<p>Durante l' <strong>Analysis</strong> le informazioni vengono esaminate minuziosamente, così che si possano tracciare delle conclusioni corroborate dalle prove raccolte. Questa fase deve essere condotta in laboratorio perché impone maggior rigore nella procedura rispetto al survey; deve infatti garantire la ripetibilità dei risultati, l'applicazione del metodo scientifico per la verifica delle ipotesi e l'utilizzo di un metodo iterativo di validazione.
</p>
<p class='vspace'>Pur essendo prevalentemente ad appannaggio della forensic, questa fase può essere molto utile anche per il comparto investigativo con cui si sta cooperando (o si coopererà). Bisogna dunque documentare nella <em>timeline</em> tutto quello che è stato fatto e che si sta facendo, ad esempio telefonate in entrata e uscita, nuove fonti acquisite, pause fatte, etc...
</p>
<p class='vspace'>Chi si occupa dell'analysis è chiamato anche <strong>Forensics Examiner</strong>, ed è una persona che deve avere certificazioni in campo informatico rilasciate da organismi conosciuti come il SANS institute o il Cisco, oppure dagli sviluppatori di software di computer forensic.
</p>
<div class='vspace'></div><h3>Reconstruction </h3>
<p>La <strong>reconstruction</strong> ha sia una componente di analisi che di investigazione ed ha lo scopo di mettere insieme tutti gli indizi raccolti così da costruire una visione di insieme dell'accaduto. Ovviamente non tutte le prove vanno considerate allo stesso modo, ma ognuna delle digital evidence deve essere classificata in base ad un <em>trust level</em> (livello di fiducia) ovvero al peso della prova stessa. Ad esempio un log di cui non conosco la fonte potrebbe avere peso 1, ma il suo trust level potrebbe aumentare se riesco a correlarlo ad altre fonti e altri log. 
</p>
<p class='vspace'>Anche in questa fase viene utilizzato il metodo scientifico per avvalorare o meno le teorie basate sulle fonti di prova raccolte in un modo molto simile a quanto avveniva nell'analysis.
</p>
<div class='vspace'></div><h3>Presentation </h3>
<p>Concludiamo con la <strong>presentation</strong>, ovvero la fase in cui avviene la presentazione delle digital evidence ai vari attori del processo investigativo, investigatori esterni compresi. 
</p>
<p class='vspace'>Presentation e reconstrucion sono entrambe multi-livello: si mantiene un livello più alto di carattere generale per le decisioni rapide (che si interfaccia ad esempio col management) ed uno più basso con le descrizioni tecniche dell'accaduto. 
</p>
<p class='vspace'>E' buona abitudine inserire in ogni rapporto anche un glossario con i termini usati, in quanto non si conosce a priori il grado di preparazione di chi lo legge ed è meglio non dare nulla per scontato. Più la relazione è semplice e chiara e minore è il numero di fraintendimenti possibili.
</p>
<div class='vspace'></div><h2>Aspetti legali dell'investigazione</h2>
<p>Nella gestione degli incidenti informatici non si può prescindere dal contesto legale poiché non esiste processo (<em>task</em>) che non abbia una rilevanza o un riscontro di tale tipo. Va infatti considerato che (dalle slide di Dario Forte, 2008): 
</p><ul><li>"Ogni incidente ha un potenziale sbocco giudiziario"
</li><li>"La tutela legale è di interesse in azienda"
</li><li>"Esistono delle responsabilità ben precise che cadono sugli operatori e sui rispettivi supervisori di processo", e ci possono volere anche 3 anni prima di avere una ripercussione visibile 
</li></ul><p class='vspace'>La regola numero uno è <strong>trattare ogni incidente come se dovesse terminare in un'aula di tribunale</strong>, cosa da far sempre presente anche se dall'alto dicono che non si devono prendere certe precauzioni (come il fare un'immagine del disco, ad esempio). Il decreto legge n.231 dell'8 giugno 2001 introduce infatti l'obbligo di dover rispondere come persona giuridica per i reati commessi all'interno della propria struttura, il che significa che si ha sempre la responsabilità delle proprie azioni. 
</p>
<p class='vspace'>Facciamo un esempio pratico: le forze dell'ordine mi chiedono di acquisire delle prove che mi hanno portato, cosa devo fare?
</p><ol><li>Notificare l'acquisizione (firma, controfirma, fotografie, ...) 
</li><li>Verificare le fonti della prova, anche attraverso il controllo di sigilli fisici o virtuali (hash)
</li><li>Chiedere se le prove consegnate sono già delle copie o sono gli originali
</li><li>Se infine mi rendo conto che le prove sono inquinate o comunque in uno stato tale per cui potrebbero portarmi in tribunale a risponderne, posso rifiutarmi di acquisirle a patto di documentarne la motivazione
</li></ol><p class='vspace'>Ci sono degli standard investigativi da tenere in considerazione per poter analizzare l'evento e trarne conclusioni valide. Un investigatore che si occupa di crimini informatici deve saper consultare il codice penale e quello di procedura penale, sapere come operano le forze dell'ordine e l'autorità giudiziaria, e conoscere inoltre la differenza tra procedibilità d'ufficio (quando l'azione penale parte senza denuncia) o a querela. In ambito civile la rigidità scientifica della prova è minore di quella penale, anche se storicamente sta diventando altrettanto schematica e rigorosa. Infine, per quanto riguarda le indagini amministrative, queste vengono generalmente condotte come se fossero penali poiché spesso sfociano in esse; nell'amministrativo l'investigatore deve considerare tra le altre cose eventuali incompatibilità con lo statuto dei lavoratori o con la legge sulla privacy. 
</p>
<p class='vspace'>Cosa serve allora a un investigatore per condurre indagini di tipo investigativo o forense? Innanzitutto un minimo di conoscenze di criminologia, poi sicuramente le leggi (tenendo conto del fatto che se stiamo operando all'estero siamo vincolati e legalmente punibili con le norme di quel paese), nozioni di base sull'analisi dei log e dei computer delle vittime, e infine strumenti di <em>case management</em> e <em>forensics</em>. 
</p>
<p class='vspace'>Concludiamo con una serie di definizioni correlate all'aspetto legale della gestione degli incidenti informatici: 
</p><ul><li><strong>Tainted Fruit</strong>: sono le fonti di prova acquisite in modo improprio (<code class='escaped'>tainted</code> significa infatti <em>contaminato</em>), ovvero con violazioni della privacy o della legge; ad esempio potrebbero essere le intercettazioni abusive. Queste prove non possono essere utilizzate in tribunale, ma è pratica comune raccoglierle e tener comunque conto dei risultati ai fini dell'indagine; va ricordato infatti che attualmente ci sono due trend di incident response: <em>Difesa Offensiva</em> e <em>Investigazione non Denunciata</em>; 
</li><li><strong>Chain of custody</strong>: è l'inventario delle fonti di prova acquisite durante l'investigazione o la forensic. Ogni evidence deve essere sigillata, fisicamente o elettronicamente; 
</li><li><strong>Subpoena</strong>: è l'equivalente americano del <em>decreto del pm</em> o <em>ordine di esibizione dell'agente giudiziario</em>. Potrebbe prevedere una testimonianza del perito nel paese estero che l'ha richiesto, e va detto che pur non essendo obbligatorio - si tratta comunque di una richiesta - un rifiuto potrebbe avere ripercussioni sulla carriera dell'investigatore.
</li></ul><div class='vspace'></div><h2>Forensic Readiness</h2>
<p>La <strong>forensic readiness</strong> è il processo imprescindibile di preparazione alle indagini digitali, grazie al quale è possibile stabilire se si è pronti all'incident response e alla digital investigation.
</p>
<p class='vspace'>La prima fase riguarda l'osservazione degli assesment:
</p><ol><li>fare l'inventario degli asset
</li><li>localizzare la posizione fisica delle informazioni e studiare la loro struttura;
</li><li>identificare i punti in cui le informazioni possono essere attaccate
</li></ol><p class='vspace'>Fatto ciò rimangono altre attività preliminari da portare a termine. Per prima cosa bisogna verificare la presenza di piani di <em>Disaster Recovery</em> per far fronte ad eventi gravissimi (come terremoti, alluvioni, fulmini, ...) o furti, poiché l'integrità fisica delle fonti di prova va sempre messa in primissimo piano. Il passo successivo è quello della pianificazione della fase di <em>preservation</em>, anche attraverso la creazione e il mantenimento di un inventario che consenta allo stesso tempo di sapere quali dispositivi/strumenti abbiamo a disposizione e di non perderne nessuno.
</p>
<p class='vspace'>In un contesto aziendale l'operatore è la figura che rischia più di tutti per le sue mancanze ("<em>i manager cadono sempre in piedi</em>"), dunque gli conviene essere veloce, lineare e corretto. Per la velocità - come detto più volte - più si è preparati e minore è il tempo di risposta all'incidente, mentre per quanto riguarda la correttezza il principio è <em>non fare niente senza prima aver consultato la legge e gli assesment aziendali</em>. Una buona pratica per l'operatore è considerare e mantenere la propria rete come se fosse una "<em>Source of Evidence</em>", all'interno della quale garantire sempre l'integrità e l'affidabilità delle informazioni.<br />In ogni caso, se la situazione degenera vige il <code class='escaped'>Don't Panic</code>, ovvero non bisogna disperarsi ma si deve chiedere istruzioni e consigli all' <em>helper</em> (se esiste) o chi per esso (se non esiste, PANIC!). 
</p>
<p class='vspace'>Una preparazione inadeguata può portare a problematiche di vario tipo, tra cui: negligenze o sbagli, acquisizioni di evidence in modo illecito (<em>tainted fruit</em>), fuga di informazioni e conclusioni affrettate e/o errate.
</p>
<div class='vspace'></div><h2>Approfondimenti</h2>
<h3>Acquisizione</h3>
<p>Abbiamo detto che la fase di <em>preservation</em> ha come obiettivo quello di preservare le fonti di prova acquisite, così da poter garantire l'integrità dei dati da analizzare; questo tipo di acquisizione (detta <em>logica</em>) è eseguita nel rispetto dei capisaldi dell'indagine forense, tenendo ad esempio conto degli ordini di volatilità dell'informazione. Si rivela dunque fondamentale un processo di <em>validazione</em> che attesti la genuinità dei dati, validazione che può avvenire internamente al laboratorio o esternamente ad opera di una comunità o altra parte certificata.
</p>
<p class='vspace'>Ci sono tuttavia dei casi in cui l'acquisizione non è praticabile, dunque diventa difficile - se non impossibile - garantire la preservation. Vediamone alcuni:
</p><ul><li>file system troppo grandi per poter essere duplicati
</li><li>file system non riconosciuti dagli strumenti di analisi adoperati (ad esempio <code class='escaped'>Lotus Notes</code> dà spesso problemi di questo tipo)
</li><li>"casi contingenti di procedura penale" (ad esempio la <em>Convenzione di Budapest</em>) o "eventi esogeni" (come sfortuna o urgenze diverse)
</li><li><strong>Live System Analysis</strong>, cui spesso si ricorre per la verifica iniziale e la risposta immediata all'incidente
</li></ul><p class='vspace'>Come cercare di tutelare le fonti di prova in questi casi? Ad esempio utilizzando dispositivi come gli <strong>hardware write blocker</strong>, che impediscono l'accesso in scrittura sui media su cui intervengono facendo sì che i dati originali non siano mai alterati. L'accesso in <code class='escaped'>read-mode</code> sui dati viene anche chiamato <em>preview</em>. Ci sono versioni diverse di questi dispositivi, a seconda dell'interfaccia supportata (SCSI, SATA, ..) e della modalità di interfacciamento col computer (USB, IDE, Firewire, ...); il loro costo varia dai 300 ai 1500 euro.
</p>
<p class='vspace'>Quando si ha più tempo a disposizione per l'intervento la preservation delle fonti di prova viene garantita con la duplicazione dell'ambiente lavorativo della macchina compromessa. A tal fine esistono molti strumenti di <strong>clonazione</strong> (o <strong>imaging</strong>) software-based anche open-source come il diffuso <code class='escaped'>dd</code>, che in alcune versioni consente di: estrarre il layout del media da acquisire, effettuare il <code class='escaped'>wipe</code> (cancellazione definitiva) del disco su cui caricare la copia per evitare di inquinare le prove, e generare hash (MD5 o SHA1). Quest'ultima opzione è insieme al <em>CRC</em> (<em>Controllo Ciclico di Ridondanza</em>) fondamentale per il controllo dell'integrità.<br />Esistono inoltre numerosi dispositivi hardware di clonazione anche detti "a pistola" (<em>gun</em>) perché in un certo senso ne simulano il comportamento (premi il grilletto ed entrano in azione. Mah). Tra i loro vantaggi ci sono una maggiore automazione, aggiornabilità e rapidità di esecuzione; per contro invece richiedono esperienza, conoscenza delle nozioni di base, e in alcuni casi della validazione da parte della comunità (ad esempio dal <strong>NIST</strong>, <em>National Institute for Standard and Technologies</em>).
</p>
<div class='vspace'></div><h3>Obiettivi dell'investigazione</h3>
<p>Abbiamo già visto in questo capitolo molti degli obiettivi di un'investigazione digitale, proviamo ad elencarli tutti (o almeno, buona parte) come attività di ripasso:
</p><ul><li>raccogliere il maggior numero di fonti di prova possibile relative all'incidente
</li><li>verificarne l'integrità
</li><li>cautelarle, conservandole in luoghi sicuri e protetti
</li><li>cercare il più alto numero di correlazioni possibile con altre evidence
</li><li>sviluppare il profilo dell'intruder attraverso l'analisi della scena del crimine. Bisogna in altre parole capire come questi ha ottenuto l'accesso e che tipo di danno ha fatto; ci si potrebbe anche chiedere quali siano le sue motivazioni, ma fino a un certo punto dato che di questo si occupa la criminologia
</li><li>ricostruire una timeline degli eventi collegati all'incidente
</li><li>documentare con precisione il danno causato, perché questo farà risparmiare tempo in caso di consulta o presentazione in tribunale
</li><li>collaborare con le forze dell'ordine o interpellare l'autorità giudiziaria ove necessario
</li></ul><div class='vspace'></div><h3>Ricostruzione dell'incidente</h3>
<p>La <em>ricostruzione dell'incidente</em> è un'attività molto importante per diversi motivi. In primo luogo permette di chiarire la dinamica degli eventi e di valutare il livello di esposizione del sistema a vulnerabilità e rischi legali. Notare come questi due aspetti siano fortemente correlati: meno il sistema è aggiornato, maggiori sono i rischi di exploit e più siamo esposti legalmente. Certo questo discorso non vale in generale, non ad esempio per quei sistemi che se patchati perderebbero alcune librerie di cui hanno bisogno; queste eccezioni vanno però motivate attraverso un'attenta analisi del rapporto rischio/benefici, così che sarà poi il management ad assumersene le responsabilità.<br />In secondo luogo la ricostruzione è utile per scoprire le vie d'ingresso sfruttate dall'intruder per l'accesso al sistema e per mettere in luce eventuali errori di configurazione, così che si possa allo stesso tempo evitare che l'incidente si ripeta in futuro (<em>lesson learned</em>) e comunicare il pericolo a chi ha macchine simili.
</p>
<p class='vspace'>Ci sono tre tipi diversi di ricostruzione dell'incidente:
</p><ul><li><strong>ricostruzione fisica</strong>, che prevede la creazione di un mirror del computer compromesso: stesso hardware, stesso software, immagine del disco bit-by-bit. E' l'opzione più rapida e fedele dato che fornisce l'esatta copia dell'ambiente in cui si è verificato l'incidente; per gli stessi motivi è però difficilmente realizzabile, dato che assemblare un sistema identico a quello in analisi non è così semplice
</li><li><strong>ricostruzione logica</strong>, che fa uso ad esempio di macchine virtuali. Permette una ricostruzione più agevole di un maggior numero di macchine, ma i risultati possono essere fuorvianti dato che una macchina virtuale non ha lo stesso comportamento di una reale (diverse prestazioni, diverse modalità di chiamate di funzione, ...). La ricreazione del sistema "from scratch" è un caso particolare di ricostruzione logica, che richiede la ricreazione di una serie di servizi di base per far funzionare il sistema da analizzare
</li><li><strong>ricostruzione teorica</strong>, l'ultima spiaggia se non si può accedere direttamente ai computer coinvolti nell'incidente
</li></ul><p class='vspace'>Ultima nota: durante la ricostruzione è possibile riconoscere i ruoli che hanno avuto le macchine coinvolte nell'incidente, distinguendo tra <strong>target</strong> (o <em>end point</em>, gli obiettivi finali dell'attacco) e <strong>teste di ponte</strong> (macchine compromesse per comprometterne altre).
</p>
<div class='vspace'></div><h3>Correlazione e chaining</h3>
<p>La <strong>correlazione</strong> e il <strong>chaining</strong> sono due attività fondamentali dell'investigazione perché consentono di comprovare che le tesi dimostrative da noi formulate sono basate su ipotesi fondate. In particolare durante la <em>correlazione</em> vengono relazionate le prove digitali raccolte in fase di acquisizione, mentre nel <em>chaining</em> vengono concatenati gli eventi occorsi durante l'incidente, così da confermare l'attendibilità delle evidence e aumentarne il peso in fase dimostrativa.
</p>
<p class='vspace'>Più correliamo e concateniamo e più siamo in grado di capire la dinamica di ciò che è successo. Bisogna perciò cercare il maggior numero di punti di correlazione possibili, anche se si trovano al di fuori del nostro perimetro investigativo; vanno quindi considerate anche le trust relationship, ovvero quei sistemi o piattaforme simili o omogenei a quelle di nostra competenza, e tutte le connessioni temporanee o permanenti riconducibili alla macchina compromessa (così da tener conto anche di eventuali teste di ponte). Per quanto riguarda le trust relationship alcuni esempi da verificare sono: 
</p><ul><li>sistemi che appartengono allo stesso range di indirizzi IP, perché oggetto di studio approfondito da parte degli attacker per scoprirne le vulnerabilità
</li><li>sistemi con almeno un servizio in comune con il sistema vittima (come l'FTP, il DNS o l'SMTP)
</li><li>sistemi che si trovano nello stesso segmento di rete, perché se ad esempio l'attacco è stato sferrato a un router potrebbero essere stati a loro volta compromessi
</li><li>sistemi che si trovano nello stesso dominio trusted, perché l'attaccante può mascherarsi da uno di questi per ottenere l'accesso autorizzato alla macchina
</li><li>sistemi che hanno lo stesso sistema operativo
</li><li>sistemi che condividono file o informazioni, perché se tale condivisione è mal configurata potrebbe consentire un accesso da remoto non desiderato
</li></ul><p class='vspace'>Come detto in precedenza la correlazione si opera sui vari tipi di evidence raccolti, riconducibili a tre categorie fondamentali:
</p>
<div class='vspace'></div><ul><li><em>host level</em>, ad esempio effettuando una <em>live analysis</em>, una <em>file system analysis</em> o una <em>binary analysis</em>
</li><li><em>service level</em> (livello di servizio), che esamina il comportamento del servizio ad esempio con l'ausilio della <em>log analysis</em>
</li><li><em>network level</em>, che all'analisi dei log affianca la <em>network forensic</em>
</li></ul><p class='vspace'>Correlare i vari tipi di evidence tra loro è fondamentale per ricostruire esattamente gli eventi durante l'intrusione e prima e dopo la compromissione. Riportiamo un esempio esaustivo di tale attività dalle slide del professor Dario Forte: "E' ad esempio possibile risalire alla compromissione del sistema analizzando i logi di un servizio vulnerabile; correlando l'ora dell'avvenuto exploit presente nei log con i timestamp di creazione dei file prodotti nella parte di analisi del file-system è possibile tracciare eventuali file creati nel sistema a seguito dell'intrusione. Inoltre mediante la revisione delle registrazioni delle conversazioni di rete e dei log degli apparati è possibile concludere che i binari installati sul sistema procedevano alla ricerca di nuovi bersagli da attaccare; tale affermazione può venire confermata da una successiva analisi dei binari stessi. Nel caso si fosse proceduto ad una fase di live-analysis sul sistema è possibile che vi sia la presenza di tali processi attivi sul sistema, confermati da eventuali porte di rete aperte."
</p>
<p class='vspace'>Riconsideriamo ora l'event chaining, ovvero quell'attività di basso livello che consiste nel chiarire la catena degli eventi occorsi ricostruendo lo scenario. Gli eventi da considerare possono essere sia a livello di log che di file system e non è necessario che siano direttamente connessi all'attacco; ad esempio va tenuto conto anche delle cancellazioni di possibili file di prova. Più precisamente ciò che si fa è formulare una prima ipotesi a fronte delle evidence acquisite, dopodiché si riproduce a livello di laboratorio l'attacco così come ipotizzato in modo che l'ipotesi possa essere o meno confermata; in caso negativo si fa un rollback e si procede a formulare una seconda ipotesi.
</p>
<div class='vspace'></div><hr />
<p><a class='wikilink' href='GestioneDegliIncidentiInformatici.html'>Torna alla pagina di Gestione degli incidenti informatici</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/DigitalInvestigationEDigitalForensic)</span></div>
  </div>
</body>
</html>
