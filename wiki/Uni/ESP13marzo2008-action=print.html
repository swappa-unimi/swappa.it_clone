<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / ESP - Lezione del 23 Ventoso 216 </title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='ESP13marzo2008.html' title='ESP - Lezione del 23 Ventoso 216 '>ESP - Lezione del 23 Ventoso 216 </a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
</p><pre  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'> <strong>:: Lezione del 23 Ventoso 216 ::</strong>
</pre><p class='vspace'  style='text-align: center;'><span  style='background-color: #d9e4f2; font-size: 11pt; padding: 4px; padding-left: 50px; padding-right: 50px;'><strong>... altrimenti noto come 13 marzo 2008</strong></span>
</p>
<p class='vspace'><a class='wikilink' href='ElementiSicurezzaPrivatezza.html'>Torna alla pagina di ESP</a>
</p>
<div class='vspace'></div><h2>Autenticazione</h2>
<p>L'autenticazione in Apache in genere avviene semplicemente tramite una coppia login - password, memorizzata ed inviata in chiaro. Il file <strong>.htaccess</strong> che si può creare in ogni dir servita da Apache specifica gli utenti e i loro privilegi.
</p>
<p class='vspace'>Si può anche decidere di crittare le password, per dare quel tocco di sicurezza in più che non guasta mai. A questo scopo Apache utilizza il sistema <strong>digest</strong>, ovvero un hash MD5 di nome utente, dominio e password, più un certo numero detto <strong>nonce</strong> che il server passa al client, e viene usato per rendere ancora più univoche le stringhe MD5.
Viene passata al server la stringa risultata da questa funzione:
</p>
<div class='vspace'></div><pre> MD5(MD5(&lt;password&gt;)+":"+&lt;nonce&gt;+":"+MD5(&lt;method&gt;+":"+&lt;uri&gt;))
</pre><p class='vspace'>L'unico problema è che non tutti i browser supportano il digest di Apache, quindi non è utilizzato in generale.
</p>
<p class='vspace'>Nota: MD5 è una funzione di hash crittografico, che offre ben poche possibilità che due stringhe in input producano lo stesso hash.
</p>
<div class='vspace'></div><h3>Token Hardware</h3>
<p>Si tratta di un aggeggio fisico, nato come evoluzione del sistema <strong>One Time Password</strong>. Questo aggeggio viene sincronizzato con un server, e in base al timestamp viene generato, a partire da un PIN e da un seme ignoto all'utilizzatore ma noto al server, una certa password. Il server la genera per conto suo: se coincidono, siamo tutti felici e contenti.
</p>
<div class='vspace'></div><h3>Identify Friend Or Foe = IFF</h3>
<div><span class='frame lfloat'><img src='../uploads/Uni/banana.jpg' alt='' title='' /><br /><strong>IFF</strong></span></div>
<p>IFF (Ingoio Frutti Fallici) è un sistema di <strong>Challenge Response</strong>, nato all'inizio per scopi militari: identificare come nemici o amici gli aerei che viaggiavano nello spazio aereo americano al di sopra di una certa quota. Anzi, il sistema Challenge Response è stato modellato sull'IFF.
</p>
<p class='vspace'>Viene fatta una certa domanda, e se l'aereo è amico, sa rispondere nel modo giusto. Per aggiungere un layer di sicurezza si crittano entrambi i flussi di informazioni. Le domande avvengono sui 1030 Mhz, le risposte sui 1090 Mhz.
</p>
<p class='vspace'>Ma c'è il problema del <strong>Man in the Middle</strong>. Supponiamo che l'aereo A sia amico, e il B nemico. A invia una domanda a B. B, invece di rispondere, <em>replica</em> la stessa domanda ad A. A, al ricevere la domanda, invierà la risposta. B riceve la risposta, e quindi sa che cosa rispondere ad A per spacciarsi come amico:) Per questo occorre che ci si autentichi in qualche modo, incorporando ID dell'aereo e cose simili, per evitare casini.
</p>
<div class='vspace'></div><h3>SINGLE SIGN ON</h3>
<p>Internet è fatta di tanti servizi sparsi qua e là, sistemi distribuiti a più non posso. Ogni servizio richiede in genere che uno si iscriva e che poi ad ogni utilizzo si autentichi. Capita quindi di dover iscriversi a decine di cose diverse, con decine di account e password diverse.
Questo significa 2 cose:
</p><ul><li>i miei dati sono noti a tanti siti diversi;
</li><li>ho tante password in giro, il che vuol dire che per non dimenticarle le faccio tutte uguali, con gli ovvi problemi di sicurezza che ciò comporta.
</li></ul><p class='vspace'>Allora si è pensato bene di inventare sistemi <strong>Single Sign On</strong>, in cui i servizi distribuiti cooperano e si rifanno tutti ad una singola credenziale.
</p>
<p class='vspace'>Deve quindi esserci un dominio principale, che è quello dove effettivamente io mi registro, e i domini secondari devono ripescare le mie info da quello principale. Quindi, la mia login viene effettuata solo sul dominio principale. È poi il dominio principale a comunicare ai secondari che l'autenticazione è riuscita.
</p>
<p class='vspace'>Ci sono due modi di implementare questo sistema: farlo <strong>centralizzato</strong> o creare una <strong>federation</strong>.
</p>
<div class='vspace'></div><h3>SSO centralizzato</h3>
<p>Un'entità ha tutti i miei dati, e va quindi ben protetta. I secondari si rivolgono a lei e si scambiano info sull'autenticazione tramite protocolli come <strong>SAML</strong> (Security Assertion Markup Language) e <strong>SOAP</strong> (un protocollo per scambiarsi messaggi in XML, usando in genere HTTP come trasporto, ma anche SMTP, volendo).
</p>
<p class='vspace'>SAML contiene delle asserzioni, cioè delle affermazioni che possono essere:
</p><ul><li>di <strong>autenticazione</strong>: identifica un utente;
</li><li>di <strong>attributi</strong>: trasportano caratteristiche di un utente, eg il suo numero di carta di credito;
</li><li>di <strong>permessi</strong>: dicono che cosa un utente può fare.
</li></ul><p class='vspace'>Di per sé SAML non autentica niente, serve solo per trasportare info su di un utente.
</p>
<div class='vspace'></div><h3>Microsoft .NET Passport</h3>
<p>Microsoft ha inventato il sistema Passport, che è un SSO centralizzato, e qui vediamo un po' come funziona.
</p>
<p class='vspace'>La registrazione avviene al server centrale Passport. Ogni utente da questa registrazione riceve un <strong>PUID</strong>, cioè un <strong>Password User ID</strong>. I siti esterni che si rifanno a Passport non ricevono info di autenticazione da parte del server Passport centrale, ma solo messaggi che dicono "Ok, l'auth è andata a buon fine".
</p>
<p class='vspace'>La registrazione si cerca di fare che sia il più sicura possibile. Si utilizza il <strong>CAPTCHA</strong>, ovvero una forma di Challenge Response per umani.
Il CAPTCHA lo conoscete tutti: spesso sarà capitato di doversi iscrivere ad un sito e di dover inserire le lettere tutte storte e deformate che appaiono. In pratica si tratta di un test di Turing, ma all'incontrario: il test di Turing serviva per distinguere le macchine dagli umani, qui serve per distinguere gli umani dalle macchine. Sono immagini fatte in modo tale che solo un uomo possa distinguerle, così da evitare registrazioni automatiche. In realtà poi diversi di questi CAPTCHA sono stati crackati, ma è un'altra storia.
Infine, si invia un'email per la conferma della registrazione.
</p>
<p class='vspace'>Quando entro su di un sito partecipante, iscritto a Passport, questo sito mi rinvia appunto alla pagina di login di Passport. Se tutto va bene, Passport invierà a me 3 cookie criptati, i quali conterranno:
</p><ul><li>il mio PUID e il timestamp (perché dopo un po' la mia auth scadrà);
</li><li>le mie info di profilo;
</li><li>i siti che ho precendentemente visitato!
</li></ul><p>La storia dei siti precedentemente visitati è stata giustificata dicendo che magari un certo sito non vuole che un utente abbia visitato precedentemente la concorrenza.
</p>
<p class='vspace'>Tanto per fare un po' di storia, Passport è stato abbandonato a favore di Windows Live ID, e quest'ultimo non è più spacciato per SSO ma è offerto come un sistema di autenticazione tra gli altri. Passport aveva delle falle di sicurezza che permettevano di rubare un'identità tramite un semplice browser (!!). Inoltre, come al solito con Microsoft, la prima versione della licenza permetteva a Microsoft di disporre dei dati personali degli utenti.
La faccenda dei siti precedentemente visitati, a <a class='wikilink' href='http://www.swappa.it/wiki/Utenti/Dario'>mio</a>, avviso, si spiega facendo riferimento al mercato fiorente che riguarda le abitudini degli internauti. Per le aziende che operano su Internet è di fondamentale importanza sapere esattamente che gusti ho, per potermi venire incontro meglio. Questo è ciò a cui le varie Licenze di servizi di posta etc. si riferiscono quando parlano di utilizzo da parte di società dei nostri dati a fini commerciali etc. etc.
</p>
<p class='vspace'>Ma torniamo a noi. Questi tre cookie infami vengono crittati, e siccome vengono memorizzati sul computer dell'utente, il sito affiliato può recuperarli se gli servono.
</p>
<p class='vspace'>Siccome i cookie sono sì crittati, ma il canale di trasporto su cui viaggiano no, in genere si usa <strong>SSL</strong> (Secure Socket Layer) per queste comunicazioni.
Ma c'è dell'altro. L'autenticazione di primo livello è composta semplicemete da una coppia login - password. Quella di secondo livello invece tira in ballo un PIN, che in modo simile ai PIN dei cellulari posso sbagliare al max 5 volte di fila. Se sbaglio 5 volte, allora mi vengono fatte 3 domande tra le 10 che ho creato in fase di registrazione. E adesso potete dare un nuovo significato alla parola <em>paranoia</em>.
</p>
<p class='vspace'>Ovviamente, siccome tutto è centralizzato, Passport ha un <strong>single point of failure</strong>. Ecco qualche interessante metodo per aggirare tutto questo bailamme.
</p>
<p class='vspace'><strong>Attacco passivo</strong>: io, Bad Guy, creo un sito che assomiglia in tutto e per tutto a quello di Passport, ma magari con un indirizzo lievemente diverso (eg Pasport con una s sola). L'utente poco avveduto si registrerà presso di me:)
</p>
<p class='vspace'><strong>Attacco attivo:</strong>: il cattivone si inserisce nel canale di comunicazione tra utente e sito affiliato a password, e crea una copia per sé delle info che l'utente invia a password.
</p>
<p class='vspace'><strong>Attacco DNS:</strong>:  inquino i record DNS del mio utente, così che quando viene indirizzato a www.passport.com, l'IP è quello del mio server cattivone, il quale offre la stessa interfaccia.
</p>
<div class='vspace'></div><h3>SSO Federation</h3>
<p>Per evitare la centralizzazione, si è pensato di dividere i dati sensibili di un utente in più domini. Ciascun dominio possiede una mia <strong>identità parziale</strong>, mentre l'unione di tutte le mie identità parziali dà luogo alla mia <strong>identità di rete</strong>.
Tutti questi domini devono però essere collegati tra di loro in una sorta di Federazione Interstellare.
</p>
<p class='vspace'>Una di queste federazioni è <strong>Liberty Alliance</strong>, la quale ha creato un <em>circle of trust</em> tra chi aderisce. Si possono creare diversi circoli, e questi possono essere messi in comunicazione tra di loro, così che le mie auth viaggino un po' dappertutto.
</p>
<p class='vspace'><a class='wikilink' href='ElementiSicurezzaPrivatezza.html'>Torna alla pagina di ESP</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/ESP13marzo2008)</span></div>
  </div>
</body>
</html>
