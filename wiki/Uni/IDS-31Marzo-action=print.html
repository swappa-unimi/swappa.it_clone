<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
 <title>Swappa : Uni / Ingegneria del Software - Appunti del 31 Marzo 2009</title>
 <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />
 <meta http-equiv='Content-Language' content='en' />
 <meta http-equiv='Content-Style-Type' content='text/css' />
 <meta http-equiv="imagetoolbar" content="no" />
 <meta name='MSSmartTagsPreventParsing' content='true' />
 <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
.progress-bar {
	display: block;
	background: transparent; 
	width: 520px;
	font-size: 1px; /* for IE */
	margin: 2px 0;
}

.progress-bar .pb1, .progress-bar .pb2, .progress-bar .pb3, .progress-bar .pb4 {
	display: block; 
	background: #fff; 
	border-left:  1px solid #999; 
	border-right: 1px solid #999;

	overflow: hidden; 
	height: 1px; 
}
.progress-bar .pb1 { margin: 0 4px; background: #999;}
.progress-bar .pb2 { margin: 0 2px; border-width: 0 2px; }
.progress-bar .pb3 { margin: 0 1px; }
.progress-bar .pb4 { height: 11px; padding: 0 3px; }
.progress-bar .pb5 { display: block; background: #eeeeef; overflow:hidden; }

.progress-bar .bar {
	display: block;
	background: #a5bbd8;
	height: 11px;
	padding: 0;
}
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>
  <link rel='stylesheet' href='../pub/wsplus/wsplus.css' 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url('http://www.swappa.it/wiki/pub/wsplus/csshover.htc'); }
    .rollover * { visibility: visible; }
  </style><![endif]-->
<script type='text/javascript' src='../pub/syntaxlove/scripts/shCore.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCSharp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushCpp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushJava.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPerl.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPhp.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushPython.js'></script><script type='text/javascript' src='../pub/syntaxlove/scripts/shBrushRuby.js'></script> <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shCore.css'/>
  <link type='text/css' rel='stylesheet' href='../pub/syntaxlove/css/shThemeDefault.css'/>
  <script type='text/javascript'>
  	SyntaxHighlighter.config.clipboardSwf = 'http://www.swappa.it/wiki/pub/syntaxlove/scripts/clipboard.swf';
  	SyntaxHighlighter.all();
  </script>  <meta name='robots' content='noindex,nofollow' />

 <style type='text/css'><!--

/* Default Fonts */
body { font-family: Verdana,Arial,Helvetica,sans-serif; }
body, td, th { color:#000000; }
body, td, th { font-size: 10pt; }
small { font-size:0.85em; }
code { white-space: nowrap; }
h1, h2, h3, h4, h5 { margin-top:1em; margin-bottom:0.6em; }
h1 { font-size: 1.9em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }
h4 { font-size: 1.06em; }
h5 { font-size: 1.0em; }
ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }

/* Misc. */
body { width:auto; background-color:#ffffff; margin:0px; padding:0.5em; }
img { border-width: 0px; }
.indent { margin-left:30px; }
.outdent { margin-left:30px; text-indent:-30px; }
.vspace { margin-top:1.33em; }

/* Links */
a:link { color:#333333; font-weight:normal; text-decoration:underline; }
a:visited { color:#333333; font-weight:normal; text-decoration:underline; }
a.wikilink:hover { color: #333333; text-decoration:underline; }
a.createlink { text-decoration:none; position:relative; top:-0.5em; font-weight:bold; font-size:smaller; border-bottom:none; }
a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
a.varlink { text-decoration:none; }
.apprlink { font-size:smaller; }

/* Print View Page Header */
#printhead { font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }
#printhead a, #printhead a:visited { font-weight:bold; text-decoration:none; }
#cc { float:right; font-size:11pt; border-bottom:2px solid #a0a0a0; margin-bottom:1em; }

/* Print View Page Footer */
#printfoot { font-family: Arial,Helvetica,Geneva,sans-serif; margin-top:1em; border-top:2px solid #a0a0a0; font-size:7pt; }
  
 --></style>
</head>
<body>
  <div id='printhead'>
    <a href='../index.html' title='Swappa Home'>Swappa</a> :
    <a href='http://www.swappa.it/wiki/Uni' title='Uni Home'>Uni</a> /
    <a href='IDS-31Marzo.html' title='Ingegneria del Software - Appunti del 31 Marzo 2009'>Ingegneria del Software - Appunti del 31 Marzo 2009</a>
    <div id='cc'>
	<a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.5/it/">
	<img alt="Creative Commons License" style="border-width:0" height="15" width="80" src="http://i.creativecommons.org/l/by-nc-sa/2.5/it/80x15.png" />
	</a>
    </div>
  </div>
  
<!--PageText-->
<div id='wikitext'>
<p>
<a class='wikilink' href='IngegneriaDelSoftware.html'>Torna alla pagina di Ingegneria del Software</a>
</p><hr />
<div class='vspace'></div><pre  style='text-align: center; background-color: #ffe4c4; border: 2px solid #cccccc; font-size: 13pt; padding: 5px;'> <strong>:: Ingegneria del Software - Appunti del 31 Marzo 2009 ::</strong>
</pre><div class='vspace'></div><h2>Pattern Architetturali</h2>
<p>Un <strong>design pattern</strong> è un modo formale per documentare la soluzione ad un problema di un certo tipo. Un tale si è accorto che i problemi che si presentavano scrivendo software erano più o meno raggruppabili in certe categorie, e quindi avevano una soluzione più o meno simile. Quindi, se uno si è trovato in un certo problema e ha redatto un pattern (una sorta di modus operandi per disegnare il sw), e io mi trovo in un problema simile, posso prendere il suo pattern e adattarlo al mio caso.
</p>
<p class='vspace'>Ovviamente non è obbligatorio utilizzare pattern quando si programma, però ci facilitano di molto la vita dato che sono soluzioni riconosciute e sperimentate. Ricordiamo comunque che il pattern non è LA soluzione, ma è la forma-base del design, il che vuol dire che il codice lo devo scrivere lo stesso. In altre parole, un pattern è una <strong>soluzione parzialmente specificata</strong>. Quella totalmente specificata è il nostro software finito, mentre il pattern mi dà una base per poi lavorarci sopra.
</p>
<p class='vspace'>Una particolarità del mondo dei pattern è che spesso lo stesso pattern viene presentato con nomi diversi da autori diversi.
</p>
<p class='vspace'>Inoltre, se nel progetto da portare all'esame saremo in grado di identifcare un pattern, il professore ne sarà contento.
</p>
<div class='vspace'></div><h3>Layering</h3>
<p>Il <strong>layering</strong> è il primo pattern della storia (?) e lo si trova praticamente ovunque. L'idea è quella di <strong>dividere il software in strati</strong>, ognuno dei quali ha precise responsabilità, e ogni strato parla solamente con lo strato sopra e quello sotto. In questo modo so esattamente a chi rivolgermi e con che semantica, e non devo tenere conto di variazioni di componenti lontani da me dei quali non dovrebbe interessarmi nulla.
</p>
<p class='vspace'>Un esempio noto di layering è lo stack ISO/OSI, che ad esempio disaccoppia il DNS dal livello IP mettendoci di mezzo il protocollo TCP (o UDP). Tanto per non farci mancare un po' di sigle.
</p>
<p class='vspace'>Nota di folklore: il sistema operativo DOS non adottava il layering ma ricercava un'alta intradipendenza tra componenti; UNIX invece lo persegue strettamente.
</p>
<div class='vspace'></div><h3>Documentare un pattern</h3>
<p>Come si fa a documentare un pattern, cioè a "scriverlo giù" in modo che sia recuperabile, riconoscibile e riutilizzabile in futuro?
</p>
<p class='vspace'>In genere si utilizzano i <strong>diagrammi di collaborazione</strong> e i <strong>diagrammi di sequenza</strong>. Vedi la <a class='wikilink' href='IDS-7Aprile.html'>lezione su UML</a> o quella del <a class='wikilink' href='IDS-30Marzo.html'>30 Marzo</a> per capire un po' che cosa sono.
</p>
<div class='vspace'></div><h3>Model-View-Controller</h3>
<p>Questo è il pattern più famoso, nato insieme ai primi linguaggi ad oggetti (ad esempio SmallTalk), e in diverse salse salta fuori sempre.
</p>
<p class='vspace'>L'idea di fondo è che si vogliono dividere le responsabilità tra:
</p><ul><li>interfaccia (view, cioè la GUI)
</li><li>modello (business logic)
</li><li>comunicazione tra i due (controller)
</li></ul><p class='vspace'>Il <strong>modello</strong> è il pezzo di sw che risolve effettivamente il mio problema, ad esempio la quadratura del cerchio.
</p>
<p class='vspace'>L<strong>'interfaccia (view)</strong> è il pezzo di software che si preoccupa di mostrare al mio utente i parametri per configurare il modello, e visualizzarne l'elegante soluzione.
</p>
<p class='vspace'>Il <strong>controller</strong> è il disaccoppiatore tra l'interfaccia ed il modello.
</p>
<p class='vspace'>Perché mai mi serve un disaccoppiatore? Il motivo è che se cambio l'interfaccia, questo non deve riguardare in nessun modo il modello. Con un disaccoppiatore in mezzo, riesco a tenere distinte le cose (al viewer non frega niente se il modello gli passa il risultato della query sbagliato). E se ci fate caso, è una variazione sul tema del layering...
Notate che il disaccoppiatore può essere scritto anche solo con due righe di codice, non deve essere necessariamente complesso.
</p>
<p class='vspace'>Il funzionamento del software sarà quindi scomposto nei seguenti momenti:
</p><ol><li>l'utente mette nella GUI i suoi dati, e preme il pulsante "Calcola"
</li><li>la GUI passa i dati al controller
</li><li>il controller li passa al modello
</li><li>il modello fa i conti e ritorna un risultato alla GUI
</li></ol><p class='vspace'>Se domani decido che il mio modello è sbagliato, e ne scrivo un altro con un'altra interfaccia pubblica, la GUI posso riutilizzarla: dovrò solo aggiornare il lato del Controller che ha a che fare con il modello.
</p>
<p class='vspace'>Vediamo il diagramma sequenziale: 
</p>
<div class='vspace'></div><div  style='text-align: center;'><img src='../uploads/Uni/mvc.jpg' alt='' title='' /></div>
<p class='vspace'>Dal diagramma osserviamo che il disaccoppiamento funziona solo da sinistra a destra, con il controller che non fa conoscere i dettagli del modello alla view, ma non il viceversa: M deve restituire alla V quello che lei si aspetta o che comunque sarà in grado di gestire.
</p>
<div class='vspace'></div><h3>Model-View-Presenter</h3>
<p>L'idea dell'MVC è buona, ma il disaccoppiamento può essere reso ancora più efficace facendo in modo che lavori in full duplex: la GUI comunica solo con il Controller, e idem per il modello. In questo modo Modello e GUI rimangono ben distanti, così come deve essere.
</p>
<div class='vspace'></div><div  style='text-align: center;'><img src='../uploads/Uni/mvp.jpg' alt='' title='' /></div>
<p class='vspace'>A questo punto però il Controller non si chiama più controller, bensì <strong>Presenter</strong>, ma la differenza è solo quella citata sopra. Anzi, il MVP è una variante talmente popolare di quella originale che spesso viene chiamata MVC al posto dell'altra.
</p>
<p class='vspace'>Vediamo due esempi illuminanti sull'utilità di questo pattern.<br />Primo esempio: gestire la navigazione web da telefono e da PC. Abbiamo due interfacce, una per il telefono e una per il computer, ma il modello sotto rimane sempre lo stesso: il presenter non solo disaccoppia, ma smista al modello giusto.
</p>
<div class='vspace'></div><div  style='text-align: center;'><img src='../uploads/Uni/es1mvp.jpg' alt='' title='' /></div>
<p class='vspace'>Secondo esempio: abbiamo un software che gestisce funzioni matematiche, e che può avere moduli diversi a seconda del ramo in cui è specializzato (aritmetica, algebra, ...). A seconda di quello che vuole l'utente, il presenter smisterà la richiesta al modello responsabile.
</p>
<div class='vspace'></div><div  style='text-align: center;'><img src='../uploads/Uni/es2mvp.jpg' alt='' title='' /></div>
<p class='vspace'>Notiamo per inciso che questa è la dimostrazione che il computer e l'uomo sono molto, molto diversi. La necessità di disaccoppiamento nello scrivere software decente ha la stessa importanza della necessità di accoppiamento che caratterizza l'essere umano. Noi e le macchine non andremo mai d'accordo.
</p>
<div class='vspace'></div><h3>Observer-Notifier</h3>
<p>Consideriamo ora un altro pattern, che non sia solo orientato alle funzioni ma anche alle performance, ovvero che ottimizzi le risorse e prenda le decisioni (parallelizzare le attività, concentrarle o distribuirle su più componenti, ...) più adatte a limitare gli sprechi e aumentare le prestazioni. Ha diversi nomi:
</p><ul><li><strong>Observer-Notifier</strong> (quello più usato)
</li><li>Observer-Observed
</li><li>Listener
</li></ul><p class='vspace'>Quale che sia il nome, il problema cui si pone come soluzione è quello in cui alcuni componenti siano costretti ad attendere il risultato di componenti più lenti.
</p>
<p class='vspace'>Ci sono due soluzioni semplici, che ovviamente non vanno bene:
</p><ol><li>l'Osservatore si connette all'Osservato e attende finché non arrivano notizie
</li><li>L'Osservatore si connette a intervalli regolari all'Osservato e chiede se ci sono notizie
</li></ol><p class='vspace'>Perché non vanno bene? Nel caso 1 il problema è che se non succede niente, io rimango tutto il giorno ad aspettare. Nel caso 2 è che potenzialmente posso passare il giorno a fare polling (estrarre campionamenti ogni tot tempo) sull'Osservato, senza ottenere comunque nulla, oppure perdermi dei passaggi intermedi se faccio polling con una frequenza troppo bassa. Inoltre, in entrambi i casi potrei perdere tempo ad attendere un evento che non mi interessa nulla, solo per non dovermi perdere l'evento successivo che invece mi interessa molto.
</p>
<p class='vspace'>Soluzione: si crea un servizio intermedio, detto <strong>notifier</strong>, che fa da servizio di allerta.
</p>
<p class='vspace'>Il Notifier si connette all'Osservato, e si fa dire tutto sempre. Poi, l'Osservatore a sua volta si registra presso il Notificatore, e gli dice di quali e quanti eventi dell'Osservato desidera essere messo a conoscenza. Quando il Notificatore rileva eventi nell'Osservato, guarda la sua lista di Osservatori e decide a quali di essi inviare l'esempio.
</p>
<p class='vspace'>Caricare tutto sul Notifier non è come spostare il problema dall'Observer su di lui, perché avrà sì lo stesso carico di lavoro, ma distribuito su più clienti. Se infatti non è giustificato che l'osservatore sia impegnato full time in attesa di un evento, la cosa ha senso per un processo come il notifier.
</p>
<p class='vspace'>Anche questa è una variazione sul tema del layering.
</p>
<div class='vspace'></div><h2>Da Casi d'Uso a Diagramma delle Classi</h2>
<p>Dai CdU siamo già in grado (più o meno) di tirare fuori il diagramma di collaborazione e il diagramma di sequenza. Adesso è giunto il momento di tirare fuori da questi il <strong>diagramma delle classi</strong>.
</p>
<p class='vspace'>Prendiamo l'ultimo pattern che abbiamo visto, quello del Notifier. Avrò sicuramente tre classi:
</p><ol><li>Observer
</li><li>Notifier
</li><li>Observed
</li></ol><p class='vspace'>Nel diagramma di sequenza avrò delle frecce che rappresentano le chiamate. Ebbene: ogni freccia <strong>verso</strong> una classe rappresenta un metodo pubblico di <strong>quella classe</strong>.
</p>
<p class='vspace'>C'è anche un'altra cosa da notare. Supponiamo che la classe Observer voglia modificare qualche attributo della classe Notifier, ad esempio "Frequenza Di Polling". In un ipotetico linguaggio di programmazione, basterebbe scrivere in un metodo qualsiasi di Observer:
</p><pre> Notifier myNotifier;
 myNotifier.PollingFrequency = 10
</pre><p class='vspace'>Questo modo di modificare i parametri altrui non è molto bello, per questi motivi:
</p><ol><li>non c'è modo di tracciarlo in nessun diagramma UML
</li><li>avviene all'insaputa del legittimo possessore dell'attributo PollingFrequency
</li></ol><p class='vspace'>Per quanto riguarda il punto 2, se Notifier è stato scritto presupponendo che PollingFrequency non superasse mai il valore 10, il poter modificare questo attributo alla carlona dall'esterno è veramente pericoloso.
</p>
<p class='vspace'>Il punto 1 invece mi dice che nella mia progettazione non ho alcuno modo di scrivere, e quindi tener conto, dell'eventualità della modifica del valore di PollingFrequency da parte di qualcuno. Non lo posso diagrammare, quindi lo lascio alla libera iniziativa del programmatore etc. etc.
</p>
<p class='vspace'>Pertanto, tutti gli attributi di una classe che possono essere modificati dall'esterno NON devono essere accessibili direttamente al pubblico, ma devono essere modificati tramite dei metodi scritti apposta, i cosiddetti <strong>check</strong> e <strong>set</strong>.
</p>
<p class='vspace'>Ad esempio, la classe Notifier potrebbe avere dei metodi così:
</p>
<div class='vspace'></div><pre> public int checkPollingFrequency() {
    return this.PollingFrequency;
 }

 public bool setPollingFrequency(int newValue) {
    if (newValue &gt; 0) &amp;&amp; (newValue &lt;= 10) {
       this.PollingFrequency = newValue;
       return true;
    } else {
       return false;:
    }
 }
</pre><p class='vspace'>Quindi, se qualcuno dall'esterno vuole modificare il valore di PollingFrequency, da un lato non potrà farlo impunemente, e dall'altro, dovendo ricorrere ad un metodo, il suo tentativo sarà ben segnalato nel diagramma delle sequenze.
</p>
<div class='vspace'></div><hr />
<p><a class='wikilink' href='IngegneriaDelSoftware.html'>Torna alla pagina di Ingegneria del Software</a>
</p>
</div>

  <div id='printfoot'>
    <div class='printview'>(Printable View of <span style='white-space:nowrap;'>http://www.swappa.it/wiki/Uni/IDS-31Marzo)</span></div>
  </div>
</body>
</html>
